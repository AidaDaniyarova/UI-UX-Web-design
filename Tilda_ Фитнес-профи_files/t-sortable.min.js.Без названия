(()=>{"use strict";function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}function e(t){var e=a();return function(){var n,r=i(t);if(e){var a=i(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function n(t){var e="function"==typeof Map?new Map:void 0;return n=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,a)}function a(){return r(t,arguments,i(this).constructor)}return a.prototype=Object.create(t.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),o(a,t)},n(t)}function r(t,e,n){return r=a()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var a=new(Function.bind.apply(t,r));return n&&o(a,n.prototype),a},r.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(t){c=!0,a=t}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(a=r.key,o=void 0,o=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(a,"string"),"symbol"===s(o)?o:String(o)),r)}var a,o}function f(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var _=function(){function t(e,n){if(u(this,t),!(e instanceof Element))throw new TypeError("TSortable container is not an Element");this._container=e;var r=(n="[object Object]"===Object.prototype.toString.call(n)?n:{}).dragImage||{},a=n.ghost||{},o=n.dropBar||{},i=n.dropArea||{},s=n.autoScroll||{},l=n.nested||{};this._config={containerClassName:n.containerClassName||"tsort",dragImage:{className:r.className||"tsort__drag-image",opacity:!isNaN(r.opacity)&&r.opacity>=0&&r.opacity<=1?r.opacity:1,zIndex:isNaN(r.zIndex)?1e4:r.zIndex,offsetX:isNaN(r.offsetX)?isNaN(r.offset)?10:r.offset:r.offsetX,offsetY:isNaN(r.offsetY)?isNaN(r.offset)?10:r.offset:r.offsetY,appendTo:r.appendTo instanceof Element?r.appendTo:document.body,maxWidth:isNaN(r.maxWidth)?200:r.maxWidth,maxHeight:isNaN(r.maxHeight)?100:r.maxHeight,isRevertAnimation:void 0===r.isRevertAnimation||!!r.isRevertAnimation,counterClassName:r.counterClassName||"tsort__drag-image_counter"},noDropBetweenFromConnectedSortable:!!n.noDropBetweenFromConnectedSortable,nested:{isEnabled:!!l.isEnabled,containerTagName:l.containerTagName||"ul",containerClassName:Array.isArray(l.containerClassName)&&l.containerClassName[0]?l.containerClassName:[l.containerClassName||"tsort__list"],noNestedSelector:l.noNestedSelector||".tsort__item_nonested",noDropInsideSelector:l.noDropInsideSelector||".tsort__item_nodropinside",isExpandEnabled:!!l.isExpandEnabled,expandedClassName:l.expandedClassName||"tsort__item_expanded",noExpandSelector:l.noExpandSelector||".tsort__item_noexpand",expandTimeout:!isNaN(l.expandTimeout)&&l.expandTimeout>=0?l.expandTimeout:700,noNestableSelector:l.noNestableSelector||null},selector:n.selector||".tsort__item",noBeforeSelector:n.noBeforeSelector||".tsort__item_nobefore",specificSelector:n.specificSelector||".tsort__item_specific",noAfterSelector:n.noAfterSelector||".tsort__item_noafter",cancelSelector:n.cancelSelector||".tsort__item_cancel",handleSelector:n.handleSelector||".tsort__item",multipleSelector:n.multipleSelector||".tsort__item_selected",ghost:{className:a.className||"tsort__ghost",opacity:!isNaN(a.opacity)&&a.opacity>=0&&a.opacity<=1?a.opacity:.3},dropBar:{className:o.className||"tsort__dropbar",visibleClassName:o.visibleClassName||"tsort__dropbar_visible",zIndex:isNaN(o.zIndex)?9999:o.zIndex,overlappingPercent:!isNaN(o.overlappingPercent)&&o.overlappingPercent>=0&&o.overlappingPercent<=.5?o.overlappingPercent:.3,vIndent:!isNaN(o.vIndent)&&o.vIndent>=0?o.vIndent:20,hPadding:!isNaN(o.hPadding)&&o.hPadding>=0?o.hPadding:0},dropArea:{className:i.className||"tsort__droparea",visibleClassName:i.visibleClassName||"tsort__droparea_visible",zIndex:isNaN(i.zIndex)?9998:i.zIndex,vPadding:!isNaN(i.vPadding)&&i.vPadding>=0?i.vPadding:0,hPadding:!isNaN(i.hPadding)&&i.hPadding>=0?i.hPadding:0},autoScroll:{isEnabled:void 0===s.isEnabled||!!s.isEnabled,speedIndex:!isNaN(s.speedIndex)&&s.speedIndex>0?s.speedIndex:1,offset:!isNaN(s.offset)&&s.offset>0?s.offset:60},toleranceDistance:!isNaN(n.toleranceDistance)&&n.toleranceDistance>=0?n.toleranceDistance:6,delay:!isNaN(n.delay)&&n.delay>=0?n.delay:50,touchDelay:!isNaN(n.touchDelay)&&n.touchDelay>=0?n.touchDelay:300,touchDistance:!isNaN(n.touchDistance)&&n.touchDistance>=0?n.touchDistance:20,isAutoUpdateEnabled:!!n.isAutoUpdateEnabled},this._config.autoScroll.container=s.container instanceof Element?s.container:this._getAutoScrollContainer(),this._sortableElements=Array.from(this._container.querySelectorAll(this._config.selector)),this._onStart="function"==typeof n.onStart?n.onStart:new Function,this._onMove="function"==typeof n.onMove?n.onMove:new Function,this._onEnd="function"==typeof n.onEnd?n.onEnd:new Function,this._onBeforeDrop="function"==typeof n.onBeforeDrop?n.onBeforeDrop:new Function,this._onDrop="function"==typeof n.onDrop?n.onDrop:new Function,this._onExpand="function"==typeof n.onExpand?n.onExpand:new Function,this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handleDragStart=this._handleDragStart.bind(this),this._handleDrop=this._handleDrop.bind(this),this._handleDragMove=this._handleDragMove.bind(this),this._handleDragEnd=this._handleDragEnd.bind(this),this._throttledUpdate=this._throttle(this.update,1e3),this._preventDefaultDrag=this._preventDefaultDrag.bind(this),this._preventContextMenu=this._preventContextMenu.bind(this),this._handleExpand=this._handleExpand.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._pointerState={isButtonPressed:!1,startPosX:null,startPosY:null,startTimestamp:null,targetElement:null},this._isDropped=!1,this._isDisabled=!1,this._isDragStarted=!1,this._dropBarElements=[],this._dropAreaElements=[],this._dragImages=[],this._expandState={targetElement:null,timeoutId:null},this._draggingElements=[],this._connectedSorables=[],this._isDragStartedInConnectedSortable=!1,this._dragStartedSortable=null,this._autoScrollSpeed=0,this._autoScrollAccumulator=0,this._observer=null,this._isTouchDevice=!window.matchMedia("(hover: hover)").matches,this._dragImagePosX=0,this._dragImagePosY=0,this._connectedTo=null}return f(t,[{key:"_getAutoScrollContainer",value:function(){for(var t=this._container,e=["auto","scroll","overlay"];t&&t!==document.documentElement;){var n=window.getComputedStyle(t).getPropertyValue("overflow-y");if(e.includes(n))break;t=t.parentElement}return t||document.documentElement}},{key:"_getElementTopAndBottom",value:function(t){if(!t)return[0,0];var e=this._config.nested.containerTagName+"."+this._config.nested.containerClassName.join("."),n=t.children,r=n[0],a=r&&window.getComputedStyle(r).getPropertyValue("display"),o=n[n.length-1],i=o&&window.getComputedStyle(o).getPropertyValue("display"),s=n[n.length-2],l=s&&window.getComputedStyle(s).getPropertyValue("display");return[r&&!r.matches(e)&&"none"!==a?r.offsetTop:t.offsetTop,o&&!o.matches(e)&&"none"!==i?o.offsetTop+o.offsetHeight:s&&"none"!==l?s.offsetTop+s.offsetHeight:t.offsetTop+t.offsetHeight]}},{key:"_getDropBarElements",value:function(){var t=this._sortableElements.filter((function(t){return t.offsetHeight})),e=[];if(t.length<=1)return e;for(var n=0;n<t.length+1;n++){var r=n?t[n-1]:null,a=n<t.length?t[n]:null,o=document.createElement("div");o.classList.add(this._config.dropBar.className);var i=document.createElement("div");o.appendChild(i);var s=(a||r).offsetWidth,l=(a||r).offsetLeft,d=this._config.dropBar.vIndent,h=this._config.dropBar.hPadding,u=c(this._getElementTopAndBottom(r),2),p=u[0],f=u[1],_=f-p,m=c(this._getElementTopAndBottom(a),2),g=m[0],v=m[1];a||(g=f+d,v=f+d);var E=v-g;if(r||(p=g-d,f=g-d),a&&r&&(d=g-f)<0){var y=f,S=y+(d=this._config.dropBar.vIndent),b=r.offsetWidth,D=r.offsetLeft;f=g-d,p=g-d;var x=document.createElement("div");x.classList.add(this._config.dropBar.className);var w=document.createElement("div");x.appendChild(w);var A=this._config.dropBar.overlappingPercent,P=(S+0*A+y-_*A)/2,N=(_+0)*A+d,I=y+d/2-P+N/2;x.style.display="none",x.style.position="absolute",x.style.transform="translateY(-50%)",x.style.top=P+"px",x.style.width=b+"px",x.style.left=D+"px",x.style.height=N+"px",x.style.zIndex=this._config.dropBar.zIndex,w.style.position="absolute",w.style.transform="translateY(-50%)",w.style.left="0px",w.style.top=I+"px",e.push({dropBarEl:x,prevEl:r,nextEl:a})}var T=this._config.dropBar.overlappingPercent,C=(g+E*T+f-_*T)/2,B=(_+E)*T+d,L=f+d/2-C+B/2;o.style.display="none",o.style.position="absolute",o.style.transform="translateY(-50%)",o.style.top=C+"px",o.style.width=s+2*h+"px",o.style.left=l-h+"px",o.style.height=B+"px",o.style.zIndex=this._config.dropBar.zIndex,i.style.position="absolute",i.style.transform="translateY(-50%)",i.style.left="0px",i.style.top=L+"px",e.push({dropBarEl:o,prevEl:r,nextEl:a})}return e}},{key:"_getDropAreaElements",value:function(){for(var t=this._sortableElements,e=[],n=this._config.dropArea.hPadding,r=this._config.dropArea.vPadding,a=0;a<t.length;a++){var o=t[a];if(o.offsetHeight){var i=document.createElement("div");i.classList.add(this._config.dropArea.className),i.style.display="none",i.style.zIndex=this._config.dropArea.zIndex,i.style.position="absolute",i.style.width=o.offsetWidth+2*n+"px",i.style.height=o.offsetHeight+2*r+"px",i.style.top=o.offsetTop-r+"px",i.style.left=o.offsetLeft-n+"px",e.push({dropAreaEl:i,parentEl:o})}}return e}},{key:"_getDragImage",value:function(t,e){var n=this;this._dragImages=[];for(var r=[],a=this._config.dragImage,o=Math.min(t.length,3),i=o-1;i>=0;i--){var s=t[i].cloneNode(!0),l=t[i].getBoundingClientRect();s.classList.add(a.className),s.style.opacity="0",s.style.zIndex=a.zIndex,s.style.position="fixed",s.style.top="0px",s.style.left="0px",s.style.transformOrigin="left top",s.style.transitionProperty="opacity, transform",s.style.transitionDuration="300ms",s.style.transitionTimingFunction="cubic-bezier(0.87, 0, 0.13, 1)",s.style.translate="".concat(l.left,"px ").concat(l.top,"px"),a.appendTo.appendChild(s),this._dragImages.push(s);var c=a.maxWidth/s.offsetWidth,d=a.maxHeight/s.offsetHeight,h=Math.min(c,d)<1?Math.min(c,d):1;r.push(h)}setTimeout((function(){for(var i=0;i<o;i++){var s=n._dragImages[i],l=t[i].getBoundingClientRect(),c=o-i-1,d=Math.min.apply(Math,r)*(1-c/10);s.style.transform="\n                    scale(".concat(d,")\n                    translate(\n                        calc(").concat(s.offsetWidth/(1-c/20),"px - 100%),\n                        calc(").concat(s.offsetHeight/(1-c/10),"px - 100% + ").concat(20*c,"px)\n                    )\n                "),s.style.opacity=a.opacity*(1-c/10),n._dragImagePosX=e.x+a.offsetX,n._dragImagePosX=e.y+a.offsetY,n._animateDragImagePos(s,{x:l.left,y:l.top},{})}}),0);var u=t.length;if(u>1){var p=document.createElement("div");p.innerText=u,p.classList.add(a.className),p.classList.add(a.counterClassName),p.style.opacity="0",p.style.zIndex=a.zIndex,p.style.position="fixed",p.style.top="0px",p.style.left="0px",p.style.transformOrigin="left top",p.style.transition="opacity 300ms cubic-bezier(0.87, 0, 0.13, 1)",p.style.translate="".concat(e.x+a.offsetX,"px ").concat(e.y+a.offsetY,"px"),this._dragImages.push(p),a.appendTo.appendChild(p),setTimeout((function(){p.style.opacity=a.opacity}),300)}}},{key:"_animateDragImagePos",value:function(t,e,n,r){var a=this,o=performance.now();this._dragImageAnimationFrame=requestAnimationFrame((function i(s){var l,c=(a._dragImagePosX||n.x)-e.x,d=(a._dragImagePosY||n.y)-e.y,h=0===(l=(s-o)/300)?0:1===l?1:l<.5?Math.pow(2,20*l-10)/2:(2-Math.pow(2,-20*l+10))/2;t.style.translate="".concat(e.x+c*h,"px ").concat(e.y+d*h,"px"),h<.99?a._dragImageAnimationFrame=requestAnimationFrame(i):(a._dragImageAnimationFrame=null,t.style.translate="".concat(a._dragImagePosX||n.x,"px ").concat(a._dragImagePosY||n.y,"px"),"function"==typeof r&&r.call(a))}))}},{key:"_disableSelection",value:function(){document.body.style.setProperty("user-select","none"),document.body.style.setProperty("-webkit-user-select","none"),document.documentElement.style.cursor="default"}},{key:"_enableSelection",value:function(){document.body.style.removeProperty("user-select"),document.body.style.removeProperty("-webkit-user-select"),document.documentElement.style.removeProperty("cursor")}},{key:"_setAutoScrollSpeed",value:function(t){var e=this;if(this._autoScrollSpeed=t,this._scrollAnimationFrame&&!t)return cancelAnimationFrame(this._scrollAnimationFrame),this._scrollAnimationFrame=null,void(this._autoScrollAccumulator=0);if(t){var n,r=this._config.autoScroll.container;this._scrollAnimationFrame=requestAnimationFrame((function t(a){if(e._scrollAnimationFrame&&!e._autoScrollSpeed)return cancelAnimationFrame(e._scrollAnimationFrame),e._scrollAnimationFrame=null,void(e._autoScrollAccumulator=0);if(e._autoScrollSpeed<0&&0===r.scrollTop||e._autoScrollSpeed>0&&r.scrollTop===r.scrollHeight-r.scrollTop)return cancelAnimationFrame(e._scrollAnimationFrame),void(e._scrollAnimationFrame=null);void 0===n&&(n=a);var o=(a-n)/1e3*e._autoScrollSpeed;e._autoScrollAccumulator+=o,(e._autoScrollSpeed>0&&e._autoScrollAccumulator>=1||e._autoScrollSpeed<0&&e._autoScrollAccumulator<=-1)&&(r.scrollTop+=Math.floor(e._autoScrollAccumulator),e._autoScrollAccumulator=0),n=a,e._scrollAnimationFrame=requestAnimationFrame(t)}))}}},{key:"_validateDropBetween",value:function(t,e){var n=this._dropBarElements.find((function(t){return t.dropBarEl===e})),r=n.prevEl,a=n.nextEl,o=this._config.noBeforeSelector,i=this._config.noAfterSelector;if(r&&r.matches(i)||a&&a.matches(o))return!1;for(var s=this._config.specificSelector,l=!0,c=0;c<t.length;c++)if(!t[c].matches(s)){l=!1;break}var d=a&&a.matches(s)||!a,h=r&&r.closest(s)||!r;if(l&&!d&&!h||!l&&d&&h)return!1;if(this._config.noDropBetweenFromConnectedSortable&&this._isDragStartedInConnectedSortable)return!1;for(var u=0;u<t.length;u++){if(t[u].contains(r)||t[u].contains(a))return!1;if(r===t[u]||a===t[u])return!1}var p=this._config.nested,f=p.containerClassName,_=p.noNestableSelector;if(_&&t.some((function(t){return t.matches(_)}))){var m=".".concat(f),g=!(!r||!r.closest(m)),v=!(!a||!a.closest(m));if(g&&v||!!(r&&r.matches(_)&&v))return!1}return!0}},{key:"_validateDropInside",value:function(t,e){var n=this._dropAreaElements.find((function(t){return t.dropAreaEl===e})).parentEl,r=this._config.nested.noNestedSelector;if(n.matches(r))return!1;for(var a=this._config.nested.noDropInsideSelector,o=0;o<t.length;o++){if(t[o].contains(n))return!1;if(t[o].matches(a))return!1}return!0}},{key:"_handleExpand",value:function(t){if(this._onExpand.call(null,t),this._expandState.targetElement=null,this._expandState.timeoutId=null,!t.defaultPrevented){var e=t.targetEl;e&&e.classList.add(this._config.nested.expandedClassName),this.update()}}},{key:"_enableAutoUpdate",value:function(){var t=this,e=this._container;this._observer=new MutationObserver((function(e){var n=[];e.forEach((function(t){n.push.apply(n,l(Array.from(t.addedNodes)).concat(l(Array.from(t.removedNodes))))}));for(var r=0;r<n.length;r++){var a=n[r];if(a.nodeType===Node.ELEMENT_NODE&&a.matches(t._config.selector)){t.update();break}}})),this._observer.observe(e,{childList:!0,subtree:!0})}},{key:"_preventContextMenu",value:function(t){var e=this._config.selector,n=this._config.cancelSelector;this._isDisabled||!t.target.closest(e)||t.target.closest(n)||(t.preventDefault(),t.stopPropagation())}},{key:"_preventDefaultDrag",value:function(t){t.target.closest(this._config.selector)&&(t.preventDefault(),t.stopPropagation())}},{key:"_throttle",value:function(t,e){var n=this,r=null;return function(){for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];r||(r=window.setTimeout((function(){t.apply(n,o),window.clearTimeout(r),r=null}),e))}}},{key:"init",value:function(){var t=this;this._isDragStarted=!1,this._container.classList.add(this._config.containerClassName),this._container.style.position="relative",this._dropBarElements=this._getDropBarElements(),this._dropBarElements.forEach((function(e){return t._container.appendChild(e.dropBarEl)})),this._config.nested.isEnabled&&(this._dropAreaElements=this._getDropAreaElements(),this._dropAreaElements.forEach((function(e){return t._container.appendChild(e.dropAreaEl)}))),this._isTouchDevice?(document.addEventListener("touchstart",this._handleTouchStart),document.addEventListener("touchmove",this._handleTouchMove,{passive:!1}),document.addEventListener("touchend",this._handleTouchEnd),window.addEventListener("contextmenu",this._preventContextMenu,{passive:!1,capture:!0})):(document.addEventListener("mousedown",this._handlePointerDown),document.addEventListener("mousemove",this._handlePointerMove),document.addEventListener("mouseup",this._handlePointerUp)),this._container.addEventListener("tDragStart",this._handleDragStart),this._container.addEventListener("tDragMove",this._handleDragMove),this._container.addEventListener("tDragEnd",this._handleDragEnd),this._container.addEventListener("tDrop",this._handleDrop),this._container.addEventListener("tExpand",this._handleExpand),document.addEventListener("dragstart",this._preventDefaultDrag,{passive:!1,capture:!0}),this._isTouchDevice&&this._sortableElements.forEach((function(t){t.style.setProperty("user-select","none"),t.style.setProperty("-webkit-touch-callout","none")})),window.addEventListener("resize",this._throttledUpdate),this._config.isAutoUpdateEnabled&&this._enableAutoUpdate()}},{key:"update",value:function(){var t=this;this._sortableElements=Array.from(this._container.querySelectorAll(this._config.selector)),this._isTouchDevice&&this._sortableElements.forEach((function(t){t.style.setProperty("user-select","none"),t.style.setProperty("-webkit-touch-callout","none")})),this._dropBarElements.forEach((function(t){return t.dropBarEl.remove()})),this._dropBarElements=this._getDropBarElements(),this._dropBarElements.forEach((function(e){return t._container.appendChild(e.dropBarEl)})),this._dropAreaElements.forEach((function(t){return t.dropAreaEl.remove()})),this._dropAreaElements=[],this._config.nested.isEnabled&&(this._dropAreaElements=this._getDropAreaElements(),this._dropAreaElements.forEach((function(e){return t._container.appendChild(e.dropAreaEl)}))),(this._isDragStarted||this._isDragStartedInConnectedSortable)&&(this._dropBarElements.forEach((function(e){t._validateDropBetween(t._draggingElements,e.dropBarEl)&&(e.dropBarEl.firstElementChild.style.opacity="0",e.dropBarEl.style.display="block")})),this._dropAreaElements.forEach((function(e){t._validateDropInside(t._draggingElements,e.dropAreaEl)&&(e.dropAreaEl.style.opacity="0",e.dropAreaEl.style.display="block",t._expandState.targetElement&&t._expandState.targetElement===e.parentEl&&(e.dropAreaEl.classList.add(t._config.dropArea.visibleClassName),e.dropAreaEl.style.opacity="1"))})))}},{key:"disable",value:function(){this._isDisabled=!0}},{key:"enable",value:function(){this._isDisabled=!1}},{key:"destroy",value:function(){this._observer&&this._observer.disconnect(),this._container.classList.remove(this._config.containerClassName),this._container.style.removeProperty("position"),this._isTouchDevice?(document.removeEventListener("touchstart",this._handleTouchStart),document.removeEventListener("touchmove",this._handleTouchMove,{passive:!1}),document.removeEventListener("touchend",this._handleTouchEnd),window.removeEventListener("contextmenu",this._preventContextMenu,{passive:!1,capture:!0})):(document.removeEventListener("mousedown",this._handlePointerDown),document.removeEventListener("mousemove",this._handlePointerMove),document.removeEventListener("mouseup",this._handlePointerUp)),this._container.removeEventListener("tDragStart",this._handleDragStart),this._container.removeEventListener("tDragMove",this._handleDragMove),this._container.removeEventListener("tDragEnd",this._handleDragEnd),this._container.removeEventListener("tDrop",this._handleDrop),document.removeEventListener("dragstart",this._preventDefaultDrag,{passive:!1,capture:!0}),this._isTouchDevice&&this._sortableElements.forEach((function(t){t.style.removeProperty("user-select"),t.style.removeProperty("-webkit-touch-callout")})),window.removeEventListener("resize",this._throttledUpdate),this._dropBarElements.forEach((function(t){return t.dropBarEl.remove()})),this._dropAreaElements.forEach((function(t){return t.dropAreaEl.remove()}))}},{key:"connect",value:function(e){var n=this;if(!(e instanceof t))throw new TypeError("Connecting object is not an instance of TSortable");if(e._connectedSorables.find((function(t){return t===n})))throw new Error("This TSortable is already connected");this._connectedSorables.find((function(t){return t===e}))||(this._connectedSorables.push(e),e._connectedTo=this,e._container.addEventListener("tDragStart",this._handleDragStart),e._container.addEventListener("tDragMove",this._handleDragMove),e._container.addEventListener("tDragEnd",this._handleDragEnd),e._container.addEventListener("tDrop",this._handleDrop))}},{key:"disconnect",value:function(t){var e=this._connectedSorables.indexOf(t);-1!==e&&(this._connectedSorables.splice(e,1),t._container.removeEventListener("tDragStart",this._handleDragStart),t._container.removeEventListener("tDragMove",this._handleDragMove),t._container.removeEventListener("tDragEnd",this._handleDragEnd),t._container.removeEventListener("tDrop",this._handleDrop),t._connectedTo=null,this._isDragStartedInConnectedSortable=!1,this._dragStartedSortable=null)}},{key:"_handlePointerDown",value:function(t){this._isDisabled||this._isDragStarted||this._pointerState.isButtonPressed||1!==t.buttons||!t.target.closest(this._config.handleSelector)||!this._container.contains(t.target)||t.target.closest(this._config.selector).matches(this._config.cancelSelector)||(this._disableSelection(),this._pointerState.isButtonPressed=!0,this._pointerState.startPosX=t.clientX,this._pointerState.startPosY=t.clientY,this._pointerState.startTimestamp=performance.now(),this._pointerState.targetElement=t.target.closest(this._config.selector))}},{key:"_handlePointerMove",value:function(t){if(!this._isDisabled){1!==t.buttons&&(this._pointerState.isButtonPressed=!1);var e=this._pointerState.startPosX||0,n=this._pointerState.startPosY||0,r=t.clientX,a=t.clientY,o=Math.sqrt(Math.pow(r-e,2)+Math.pow(a-n,2)),i=this._pointerState.startTimestamp||0,s=performance.now()-i;if(this._isDragStarted&&1===t.buttons){var l=new v(this,t);this._container.dispatchEvent(l)}else if(!this._isDragStarted&&1===t.buttons&&this._pointerState.isButtonPressed&&o>=this._config.toleranceDistance&&s>=this._config.delay){this.update(),this._isDragStarted=!0;var c=new g(this,t);this._container.dispatchEvent(c)}else;}}},{key:"_handlePointerUp",value:function(t){if(!this._isDisabled){if(this._pointerState.isButtonPressed=!1,this._enableSelection(),this._isDragStarted||this._isDragStartedInConnectedSortable){var e=this._config.dropBar.className,n=this._config.dropArea.className,r=t.target.closest("."+e),a=t.target.closest("."+n),o=this._dropBarElements.find((function(t){return t.dropBarEl===r})),i=this._dropAreaElements.find((function(t){return t.dropAreaEl===a}));if(o||i){var s=new y(this,t);this._container.dispatchEvent(s),this._isDropped=!0}if(!this._isDragStartedInConnectedSortable){var l=new E(this,t);this._container.dispatchEvent(l)}}this._pointerState.startPosX=null,this._pointerState.startPosY=null,this._pointerState.startTimestamp=null,this._pointerState.targetElement=null}}},{key:"_handleTouchStart",value:function(t){this._isDisabled||this._isDragStarted||this._pointerState.isButtonPressed||1!==t.touches.length||!t.target.closest(this._config.handleSelector)||!this._container.contains(t.target)||t.target.closest(this._config.selector).matches(this._config.cancelSelector)||(this._disableSelection(),this._pointerState.isButtonPressed=!0,this._pointerState.startPosX=t.touches[0].clientX,this._pointerState.startPosY=t.touches[0].clientY,this._pointerState.startTimestamp=performance.now(),this._pointerState.targetElement=t.target.closest(this._config.selector))}},{key:"_handleTouchMove",value:function(t){if(!this._isDisabled)if(this._isDragStarted){t.cancelable&&t.preventDefault();var e=new v(this,t);this._container.dispatchEvent(e)}else if(this._pointerState.isButtonPressed){var n=performance.now(),r=this._pointerState.startPosX,a=this._pointerState.startPosY,o=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY,s=Math.sqrt(Math.pow(o-r,2)+Math.pow(i-a,2)),l=n-this._pointerState.startTimestamp;if(t.cancelable&&s<this._config.touchDistance&&l>=this._config.touchDelay){t.preventDefault(),this.update(),this._isDragStarted=!0;var c=new g(this,t);this._container.dispatchEvent(c)}}}},{key:"_handleTouchEnd",value:function(t){if(!this._isDisabled){if(this._pointerState.isButtonPressed=!1,this._enableSelection(),this._isDragStarted||this._isDragStartedInConnectedSortable){var e=this._config.dropBar.className,n=this._config.dropArea.className,r=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY,o=document.elementFromPoint(r,a),i=o&&o.closest("."+e),s=o&&o.closest("."+n),l=this._dropBarElements.find((function(t){return t.dropBarEl===i})),c=this._dropAreaElements.find((function(t){return t.dropAreaEl===s}));if(l||c){var d=new y(this,t);this._container.dispatchEvent(d),this._isDropped=!0}if(!this._isDragStartedInConnectedSortable){var h=new E(this,t);this._container.dispatchEvent(h)}}this._pointerState.startPosX=null,this._pointerState.startPosY=null,this._pointerState.startTimestamp=null,this._pointerState.targetElement=null}}},{key:"_handleDragStart",value:function(t){var e=this;if(this._isTouchDevice&&"function"==typeof window.navigator.vibrate&&window.navigator.vibrate(10),this._isDragStarted||(this._isDragStartedInConnectedSortable=!0,this._dragStartedSortable=t.tSortable),this._onStart.call(null,t),this._draggingElements=t.draggingElements,this._isDragStartedInConnectedSortable&&(this._draggingElements=this._dragStartedSortable._draggingElements),this._dropBarElements.forEach((function(t){e._validateDropBetween(e._draggingElements,t.dropBarEl)&&(t.dropBarEl.firstElementChild.style.opacity="0",t.dropBarEl.style.display="block")})),this._dropAreaElements.forEach((function(t){e._validateDropInside(e._draggingElements,t.dropAreaEl)&&(t.dropAreaEl.style.opacity="0",t.dropAreaEl.style.display="block")})),!this._isDragStartedInConnectedSortable){this._getDragImage(this._draggingElements,t.dragStartPos);var n=this._config.ghost.className,r=this._config.ghost.opacity;this._draggingElements.forEach((function(t){t.classList.add(n),t.style.opacity=r,t.style.pointerEvents="none"}))}}},{key:"_handleDragMove",value:function(t){var e,n,r,a=this;this._onMove.call(null,t),t.originalEvent.type.includes("touch")?(e=t.originalEvent.changedTouches[0].clientX,n=t.originalEvent.changedTouches[0].clientY,r=document.elementFromPoint(e,n)):(e=t.originalEvent.clientX,n=t.originalEvent.clientY,r=t.originalEvent.target),this._isDragStartedInConnectedSortable||(this._dragImageAnimationFrame?(this._dragImagePosX=e+this._config.dragImage.offsetX,this._dragImagePosY=n+this._config.dragImage.offsetY):this._dragImages.forEach((function(t){t.style.translate="".concat(e+a._config.dragImage.offsetX,"px ").concat(n+a._config.dragImage.offsetY,"px")})));var o=this._config.dropBar.className,i=this._config.dropBar.visibleClassName,s=r&&r.closest("."+o);(s&&!s.classList.contains(i)&&this._isTouchDevice&&"function"==typeof window.navigator.vibrate&&window.navigator.vibrate(10),this._dropBarElements.forEach((function(t){t.dropBarEl.classList.remove(i),t.dropBarEl.firstElementChild.style.opacity="0"})),s)&&(s.classList.add(i),s.firstElementChild.style.opacity="1");if(this._config.nested.isEnabled){var l=this._config.dropArea.className,c=this._config.dropArea.visibleClassName,d=r&&r.closest("."+l);if(d&&!d.classList.contains(c)&&this._isTouchDevice&&"function"==typeof window.navigator.vibrate&&window.navigator.vibrate(10),this._dropAreaElements.forEach((function(t){t.dropAreaEl.classList.remove(c),t.dropAreaEl.style.opacity="0"})),d){d.classList.add(c),d.style.opacity="1";var h=this._dropAreaElements.find((function(t){return t.dropAreaEl===d})),u=h&&h.parentEl,p=this._config.nested;this._expandState.timeoutId&&this._expandState.targetElement!==u&&(window.clearTimeout(this._expandState.timeoutId),this._expandState.timeoutId=null,this._expandState.targetElement=null),this._expandState.timeoutId||!p.isExpandEnabled||!u||u.matches(p.noExpandSelector)||u.classList.contains(p.expandedClassName)||(this._expandState.targetElement=u,this._expandState.timeoutId=window.setTimeout((function(){var t=new S(u);a._container.dispatchEvent(t)}),p.expandTimeout))}else this._expandState.timeoutId&&(window.clearTimeout(this._expandState.timeoutId),this._expandState.timeoutId=null,this._expandState.targetElement=null)}var f=this._config.autoScroll,_=f.container;if((!this._isDragStartedInConnectedSortable||this._dragStartedSortable._config.autoScroll.container!==_)&&f.isEnabled){var m=_.getBoundingClientRect(),g=Math.max(m.top,0),v=Math.min(m.bottom,document.documentElement.clientHeight),E=n-g-f.offset,y=v-n-f.offset,b=f.speedIndex;E<0?this._setAutoScrollSpeed(b*Math.pow(E,3)/5e3):y<0?this._setAutoScrollSpeed(-1*b*(Math.pow(y,3)/5e3)):this._setAutoScrollSpeed(0)}}},{key:"_handleDragEnd",value:function(t){var e=this;if(this._setAutoScrollSpeed(0),this._isDragStartedInConnectedSortable||this._onEnd.call(null,t),this._draggingElements=[],this._expandState.timeoutId&&(window.clearTimeout(this._expandState.timeoutId),this._expandState.timeoutId=null,this._expandState.targetElement=null),this._dropBarElements.forEach((function(t){t.dropBarEl.style.display="none",t.dropBarEl.firstElementChild.style.opacity="0"})),this._dropAreaElements.forEach((function(t){t.dropAreaEl.style.display="none",t.dropAreaEl.style.opacity="0"})),this._isDragStartedInConnectedSortable)return this._isDragStartedInConnectedSortable=!1,void(this._dragStartedSortable=null);var n=this._connectedTo&&this._connectedTo._isDropped||!1;this._dragImages&&this._dragImages.length&&(this._dragImages.forEach((function(r,a){if(r.style.opacity="0",!e._config.dragImage.isRevertAnimation||e._isDropped||n||r.matches("."+e._config.dragImage.counterClassName)){var o=getComputedStyle(r).getPropertyValue("transition-duration");o.indexOf("ms")+1?(o=o.replace("ms",""),o=parseInt(o,10)):o.indexOf("s")+1?(o=o.replace("s",""),o=1e3*parseFloat(o)):o=0,setTimeout((function(){r.remove()}),o||0)}else{r.style.transform="none";var i=t.draggingElements[a].getBoundingClientRect(),s=r.style.getPropertyValue("translate").replace(/px/g,"").split(" ").map((function(t){return parseFloat(t)}));e._dragImagePosX=0,e._dragImagePosY=0,e._animateDragImagePos(r,{x:s[0],y:s[1]},{x:i.left,y:i.top},(function(){return r.remove()}))}})),this._dragImages=[]),this._isDropped=!1,this._isDragStarted=!1;var r=this._config.ghost.className;t.draggingElements.forEach((function(t){t.style.removeProperty("opacity"),t.style.removeProperty("pointer-events"),t.classList.remove(r)}))}},{key:"_handleDrop",value:function(t){this._isTouchDevice&&"function"==typeof window.navigator.vibrate&&window.navigator.vibrate(10);var e=t.relativeTargets,n=t.draggingElements,r=this._config.nested;if(!(this._isDragStartedInConnectedSortable&&(e.nextEl&&!this._container.contains(e.nextEl)||e.prevEl&&!this._container.contains(e.prevEl)||e.parentEl&&!this._container.contains(e.parentEl))||(this._onBeforeDrop.call(null,t),t.defaultPrevented))){if(n.forEach((function(t){var e=t.closest(r.containerTagName+"."+r.containerClassName);t.remove(),e&&!e.firstElementChild&&e.remove()})),e.nextEl)n.forEach((function(t){e.nextEl.insertAdjacentElement("beforebegin",t)}));else if(e.prevEl)for(var a=n.length-1;a>=0;a--)e.prevEl.insertAdjacentElement("afterend",n[a]);else if(e.parentEl){var o,i=e.parentEl.querySelector(r.containerTagName+"."+r.containerClassName.join("."));if(i)n.forEach((function(t){i.appendChild(t)}));else(o=(i=document.createElement(r.containerTagName)).classList).add.apply(o,l(r.containerClassName)),n.forEach((function(t){i.appendChild(t)})),e.parentEl.appendChild(i)}this._config.isAutoUpdateEnabled||this.update(),window.setTimeout(this._onDrop.bind(null,t),0)}}}]),t}(),m=function(n){t(a,n);var r=e(a);function a(t,e,n){var o;u(this,a),(o=r.call(this,n,{cancelable:!0})).originalEvent=e;var i=t._pointerState;if("tDragEnd"!==n&&"tDrop"!==n){var s=i.targetElement;s.matches(t._config.multipleSelector)?o.draggingElements=Array.from(t._container.querySelectorAll(t._config.multipleSelector)):o.draggingElements=[s]}return o.dragStartPos={x:i.startPosX,y:i.startPosY},o.dragStartTimestamp=i.startTimestamp,o.tSortable=t,o}return f(a)}(n(CustomEvent)),g=function(n){t(a,n);var r=e(a);function a(t,e){return u(this,a),r.call(this,t,e,"tDragStart")}return f(a)}(m),v=function(n){t(a,n);var r=e(a);function a(t,e){return u(this,a),r.call(this,t,e,"tDragMove")}return f(a)}(m),E=function(n){t(a,n);var r=e(a);function a(t,e,n){var o;u(this,a),o=r.call(this,t,e,n||"tDragEnd");var i=t._draggingElements;return t._isDragStartedInConnectedSortable&&t._connectedSorables.forEach((function(t){var e=t._draggingElements;i.push.apply(i,l(e))})),o.draggingElements=i,o}return f(a)}(m),y=function(n){t(a,n);var r=e(a);function a(t,e){var n;u(this,a),n=r.call(this,t,e,"tDrop");var o,i=t._config.dropBar.className,s=t._config.dropArea.className;if(e.type.includes("touch")){var l=e.changedTouches[0].clientX,c=e.changedTouches[0].clientY;o=document.elementFromPoint(l,c)}else o=e.target;var d=o&&o.closest("."+i)||null,h=o&&o.closest("."+s)||null;if(d){n.placementMethod="between";var p=t._dropBarElements.find((function(t){return t.dropBarEl===d}));n.relativeTargets={prevEl:p?p.prevEl:null,nextEl:p?p.nextEl:null,parentEl:null}}else if(h){n.placementMethod="inside";var f=t._dropAreaElements.find((function(t){return t.dropAreaEl===h}));n.relativeTargets={prevEl:null,nextEl:null,parentEl:f?f.parentEl:null}}else n.placementMethod=null,n.relativeTargets={prevEl:null,nextEl:null,parentEl:null};return n}return f(a)}(E),S=function(n){t(a,n);var r=e(a);function a(t){var e;return u(this,a),(e=r.call(this,"tExpand",{cancelable:!0})).targetEl=t,e}return f(a)}(n(CustomEvent));window.TSortable=_})();